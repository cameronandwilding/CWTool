<?php
/**
 * @file
 *
 * Entity container test.
 */

/**
 * Class CWToolEntityWrapperTestCase
 */
class CWToolEntityWrapperTestCase extends DrupalWebTestCase {

  public function getInfo() {
    return array(
      'name' => 'Entity container test',
      'description' => 'Entity container test',
      'group' => 'CW',
    );
  }

  public function setUp() {
    parent::setUp(array('cw_tool'));
  }

  public function testConstructors() {
    $title = 'foobar';
    $node = $this->drupalCreateNode(array(
      'type' => 'article',
      'title' => $title,
      'status' => NODE_PUBLISHED,
    ));

    $container = NodeModel::fromNID($node->nid);
    $this->assertTrue(!empty($container), 'Node container can be initialized.');

    $this->assertEqual(
      $container->entityID,
      $node->nid,
      'Entity ID is correct.'
    );

    $this->assertEqual(
      $container->entityType,
      'node',
      'Entity type is correct.'
    );

    $this->assertEqual(
      $title,
      $container->title->value(),
      'Title is correct and entity metadata wrapper is working.'
    );

    $drupalObject = $container->getDrupalObject();
    $this->assertEqual(
      $title,
      $drupalObject->title,
      'Title exist also in drupal object.'
    );

    $containerFromNodeObject = NodeModel::fromNode($node);
    $this->assertEqual(
      $container,
      $containerFromNodeObject,
      'Load from object is same as load from ID.'
    );
  }

}
